<!DOCTYPE html>
<html>
<head>
    <script src="js/socket.io.slim.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery-ui/jquery-ui.min.js"></script>
    <title>Assistant</title>
    <link rel="stylesheet" type="text/css" href="static/style.css"></link>
</head>
<body>
<div id="conversations">
    <div id="me">Me</div>
    <div id="indicator">
        <div id="dot"></div>
    </div>
</div>

<script type="text/javascript">
var socket = io.connect();
socket.on('connect', function() {
  console.log("Connected");
});

function pulse($element, duration, toColor) {
  var factor = 4/3;
  var start = {
    'height': $element.height(),
    'width': $element.width(),
    'marginTop': parseInt($element.css("marginTop")),
    'marginLeft': parseInt($element.css("marginLeft")),
    'backgroundColor': $element.css("backgroundColor")
  };
  var color = (toColor) ? toColor : start.backgroundColor;
  console.log(color);
  $element
      .css("backgroundColor", toColor)
      .animate({
    'height': start.height * factor,
    'width': start.width * factor,
//    'marginLeft': (start.marginLeft - (start.width * (factor-1) / 2)) + "px",
//    'marginTop': (start.marginTop - (start.height * (factor-1) / 2)) + "px"
    'marginLeft': "0px",
    'marginTop': "0px"
  }, duration * (0.2), 'swing', function () {
      console.log("Out");
      $element.animate({
          'height': start.height,
          'width': start.width,
          'marginLeft': start.marginLeft,
          'marginTop': start.marginTop
      }, duration * (0.8), 'swing', function() { console.log("in")});
  });
}

$(document).ready(function() {
   
   // Let user know assistant is ready 
    socket.on('assistant_ready', function() {
//        $("#indicator").css("background-color","rgb(104, 218, 176)");
        pulse($("#dot"), 1000, "rgb(104, 218, 176)");
    });
   
   // Handle assistant events 
    socket.on('assistant_event', function(data) {
        console.log("Event", data);

        // Display recognized speech query
        if (data.type == "ON_RECOGNIZING_SPEECH_FINISHED") {
            $("#me").html(data.args.text);

        // Display Assistant response (this is actually empty)
        } else if (data.type == "ON_RESPONDING_STARTED") {
            $("#assistant").html(data.args.text);
        }
    });
$  
});
</script>
</body>
</html>

